diff --git a/KernelSU/kernel/manual_su.h b/KernelSU/kernel/manual_su.h
index 419dbfc3..490ff940 100644
--- a/KernelSU/kernel/manual_su.h
+++ b/KernelSU/kernel/manual_su.h
@@ -7,6 +7,8 @@
 
 #if LINUX_VERSION_CODE < KERNEL_VERSION(5, 7, 0)
 #define mmap_lock mmap_sem
+#elif LINUX_VERSION_CODE < KERNEL_VERSION(5, 18, 0)
+#include <linux/random.h>
 #endif
 
 #define ksu_task_is_dead(t) ((t)->exit_state != 0)
